<!doctype html><html><head><title>Doc</title><body><dl><dd><a href="#a0">define(</a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a1">batch </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a2">staticBatch </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a3">copy </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a4">saveJSON </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a5">addIndexedFields </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a6">convertArrayToObject </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a7">removeServerCreatedObjects </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a8">cleanUpSakaiDocObject</a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a9">loadJSON </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a10">convertObjectToArray </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a11">removeJSON </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a12">createSearchString </a></dd></dl><pre id="a0">define(</pre><p><b>class</b> Server  <br/><b>description</b> Server communication and batch processing. This should only hold functions which are used across multiple pages, and does not constitute functionality related to a single area/page  <br/><b>namespace</b> Server related convenience functions and communication </p><br/><pre id="a1">batch : function(_requests, _callback, _forcePOST, _async) {</pre><p>Perform a batch request to the server  <br/><b>param {Array}</b> requests The JSON object of requests <br/><b>param {Function}</b> callback Callback function, passes ({Boolean} success, {Object} data) <br/><b>param {Boolean}</b> forcePOST if we need to force a POST <br/><b>param {Boolean}</b> async If we should do an async request or not </p><br/><pre id="a2">staticBatch : function(_requests, _callback) {</pre><p>Perform a batch request for a list of static files  <br/><b>param {Array}</b> requests The static files that need to be requested <br/><b>param {Function}</b> callback Callback function, passes ({Boolean} success, {Object} data) </p><br/><pre id="a3">copy : function(config, callback) {</pre><p>Copy one node to another node  <br/><b>param {Object}</b> config JSON object which has several options - source: The source path, where you want to copy from - destination: The destination path, where you want to copy to - replace: If true, it will remove the destination branch before doing the copy <br/><b>param {Function}</b> callback A callback function which is executed at the end of the operation </p><br/><pre id="a4">saveJSON : function(i_url, i_data, callback, removeTree, indexFields, merge) {</pre><p>Saves a specified JSON object to a specified URL in JCR. The structure of JSON data will be re-created in JCR as a node hierarchy.  <br/><b>param {String}</b> i_url The path to the preference where it needs to be saved <br/><b>param {Object}</b> i_data A JSON object which we would like to save (max 200 child object of each object) <br/><b>param {Function}</b> callback A callback function which is executed at the end of the operation <br/><b>param {Boolean}</b> removeTree If we should replace the entire tree of saved data or just update it <br/><b>param {Array}</b> indexFields Fields to index in the data (used for widgets, and is optional) <br/><b>param {Boolean}</b> merge If false, it will truly replace the content during an import - the default is true  <br/><b>returns {Void}</b> </p><br/><pre id="a5">var addIndexedFields = function(path, obj) {</pre><p><b>param {Array}</b> path The path to the data object, split out <br/><b>param {Object}</b> obj The data object to add the field to </p><br/><pre id="a6">var convertArrayToObject = function(obj) {</pre><p>&lt;p&gt;Convert all the arrays in an object to an object with a unique key.&lt;br /&gt; Mixed arrays (arrays with multiple types) are not supported. &lt;/p&gt; &lt;code&gt; { 'boolean': true, 'array_object': [{ 'key1': 'value1', 'key2': 'value2'}, { 'key1': 'value1', 'key2': 'value2'}] } &lt;/code&gt; to &lt;code&gt; { 'boolean': true, 'array_object': { '__array__0__': { 'key1': 'value1', 'key2': 'value2'}, '__array__1__': { 'key1': 'value1', 'key2': 'value2'} } } &lt;/code&gt; <br/><b>param {Object}</b> obj The Object that you want to use to convert all the arrays to objects <br/><b>return {Object}</b> An object where all the arrays are converted into objects </p><br/><pre id="a7">removeServerCreatedObjects : function(obj, namespace, notToRemove) {</pre><p>Removes any objects with a given namespace  <br/><b>param {Object}</b> the object to clean <br/><b>param {Array}</b>  an array containing a string for each namespace to move </p><br/><pre id="a8">cleanUpSakaiDocObject: function(pagestructure) {</pre><p>Take a Sakai Doc object retrieved from the server and clean it so it only has the real data. This function will filter out properties that have been added on the server side during saving <br/><b>param {Object}</b> the object to clean </p><br/><pre id="a9">loadJSON : function(i_url, callback, data) {</pre><p>Loads structured preference data from a specified URL (and it's node subtree)  <br/><b>param {String}</b> i_url The path to the preference which needs to be loaded <br/><b>param {Function}</b> callback A callback function which is executed at the end of the operation <br/><b>param {Object}</b> data The data to pass to the url  <br/><b>returns {Void}</b> </p><br/><pre id="a10">convertObjectToArray : function(specficObj, globalObj, objIndex) {</pre><p>&lt;p&gt;Convert all the objects with format __array__?__ in an object to an array&lt;/p&gt; &lt;code&gt; { 'boolean': true, 'array_object': { '__array__0__': { 'key1': 'value1', 'key2': 'value2' } } } &lt;/code&gt; to &lt;code&gt; { 'boolean': true, 'array_object': [ { 'key1': 'value1', 'key2': 'value2' } ] } &lt;/code&gt; <br/><b>param {Object}</b> specficObj The Object that you want to use to convert all the objects with the special format to arrays <br/><b>param {Object}</b> [globalObj] The parent object, we need this to run over the elements recursively <br/><b>param {Object}</b> [objIndex] The index of the parent object <br/><b>return {Object}</b> An object where all the objects with the special format are converted into arrays </p><br/><pre id="a11">removeJSON : function(i_url, callback) {</pre><p>Remove the JSON for a specific node in JCR  <br/><b>param {String}</b> i_url The path of the node you want to remove <br/><b>param {Function}</b> callback Callback function which is executed at the end of the operation  <br/><b>returns {Void}</b> </p><br/><pre id="a12">createSearchString : function(searchString, handlePhrases, joinOn, tagString) {</pre><p>Create a search string for the server This method exists to transform a user's search string which they type in into the string we should pass to the server  Strings with AND, OR, '"', '-', '_' are treated as advanced search queries and left alone. Those without are transformed into term* AND term2*  <br/><b>param {String}</b> searchString The user's search <br/><b>param {Boolean}</b> handlePhrases If we should split on ,\s instead of \s to better handle phrases <br/><b>param {String}</b> joinOn String to join keywords on, defaults to AND <br/><b>param {Boolean}</b> tagString True if we are processing a directory/tag string <br/><b>return {String}</b> The string to send to the server </p><br/></body></html>