<!doctype html><html><head><title>Doc</title><body><dl><dd><a href="#a0">define(</a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a1">Container </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a2">registerFinishFunction </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a3">registerCancelFunction </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a4">informFinish </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a5">informCancel </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a6">loadWidgetData </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a7">getWidgetDataStorageURL </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a8">cssCache </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a9">widgetLoader </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a10">insertWidgets </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a11">loadWidgets </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a12">informOnLoad </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a13">locateTagAndRemove </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a14">loadWidgetFiles </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a15">locateWidgets </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a16">saveWidgetData </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a17">removeWidgetData </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a18">changeWidgetTitle </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a19">isOnDashboard </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a20">nofityWidgetShown </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a21">bindToHash </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a22">createHashURL </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a23">handleHashChange </a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a24">if (!$.isEmptyObject(sakai_widgets_config)) {</a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a25">getWidget</a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a26">getWidgetTitle</a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a27">getWidgetDescription</a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a28">insertOnLoadWidgets</a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a29">registerLazyLoading</a></dd><dd>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#a30">isRecursivelyEmbedded</a></dd></dl><pre id="a0">define(</pre><p><b>class</b> Widgets  <br/><b>description</b> Widget related convenience functions. This should only hold functions which are used across multiple pages, and does not constitute functionality related to a single area/page  <br/><b>namespace</b> Widget related convenience functions </p><br/><pre id="a1">Container : {</pre><p><b>class</b> Container  <br/><b>description</b> This will expose 2 funcions that can be called by widgets to inform the container that the widget has finished doing things in its settings mode. The container can then do whatever it needs to do according to the context it's in (f.e.: if in the personal dashboard environment, the container will want to render the view mode of that widget, in a site page edit context the container will want to insert the widget into the WYSIWYG editor).  This will also allow the container to register 2 functions related to widget settings mode. First of all, the container can register a finish function, which will be executed when a widget notifies the container that it has successfully finished its settings mode. It can also register a cancel function, which will be executed when a widget notifies the container that its settings mode has been cancelled.  <br/><b>namespace</b> Widget container functions  </p><br/><pre id="a2">registerFinishFunction : function(callback) {</pre><p>The container can use this to register a function to be executed when a widget notifies the container that its settings mode has been successfully completed. <br/><b>param {Object}</b> callback Function that needs to be executed when a widget notifies the container that its settings mode has been successfully completed. </p><br/><pre id="a3">registerCancelFunction : function(callback) {</pre><p>The container can use this to register a function to be executed when a widget notifies the container that its settings mode has been cancelled. <br/><b>param {Object}</b> callback Function that needs to be executed when a widget notifies the container that its settings mode has been cancelled. </p><br/><pre id="a4">informFinish : function(tuid, widgetname) {</pre><p>Function that can be called by a widget to notify the container that it has successfully completed its settings mode <br/><b>param {Object}</b> tuid Unique id (= id of the container this widget is in) of the widget <br/><b>param {Object}</b> widgetname Name of the widget as registered in the widget config file(e.g. sites, myprofile, video, ...) </p><br/><pre id="a5">informCancel : function(tuid, widgetname) {</pre><p>Function that can be called by a widget to notify the container that its settings mode has been cancelled <br/><b>param {Object}</b> tuid Unique id (= id of the container this widget is in) of the widget <br/><b>param {Object}</b> widgetname Name of the widget as registered in the widget config file(e.g. sites, myprofile, video, ...) </p><br/><pre id="a6">loadWidgetData : function(id, callback, infinity) {</pre><p>Load the preference settings or data for a widget <br/><b>param {String}</b> id The unique id of the widget <br/><b>param {Function}</b> callback Callback function that gets executed after the load is complete <br/><b>param {Boolean}</b> Determines whether or not the json tree descends down all the nodes. True by default. </p><br/><pre id="a7">getWidgetDataStorageURL : function(id) {</pre><p>Get the URL from which a widget should load its widget data and to which it should store its widget data <br/><b>param {String}</b> id   The unique id of the widget </p><br/><pre id="a8">cssCache : {},</pre><p>Will be used for detecting widget declerations inside the page and load those widgets into the page </p><br/><pre id="a9">widgetLoader : {</pre><p><b>name</b> sakai.api.Widgets.widgetLoader </p><br/><pre id="a10">insertWidgets : function(id, showSettings, context, widgetData, widgetDataPassthrough, callback) {</pre><p>Function that can be called by the container. This will looks for widget declarations within the specified container and will load the widgets in the requested mode (view - settings) <br/><b>param {Object}</b> id Id of the HTML container in which we want to look for widget declarations <br/><b>param {Object}</b> showSettings true  : render the settings mode of the widget false : render the view mode of the widget </p><br/><pre id="a11">loadWidgets : function(id, showSettings, context, widgetData, widgetDataPassthrough, callback) {</pre><p>Load the actual widgets <br/><b>param {String}</b> id The id of the widget <br/><b>param {Boolean}</b> showSettings true  : render the settings mode of the widget false : render the view mode of the widget <br/><b>param {String}</b> context The context of the widget (e.g. siteid) </p><br/><pre id="a12">var informOnLoad = function(widgetname) {</pre><p>Inform the widget that is is loaded and execute the main JavaScript function If the widget name is 'createsite', then the function sakai.createsite will be executed. <br/><b>param {String}</b> widgetname The name of the widget </p><br/><pre id="a13">var locateTagAndRemove = function(content, tagName, URLIdentifier) {</pre><p>Locate a tag and remove it from the content <br/><b>param {String}</b> content The complete content of a file (e.g. &lt;div&gt;...) <br/><b>param {String}</b> tagName The name of the tag you want to remove (link/script) <br/><b>param {String}</b> URLIdentifier The part that identifies the URL (href/src) </p><br/><pre id="a14">var loadWidgetFiles = function(widgetsInternal2, batchWidgets) {</pre><p>Load the files that the widget needs (HTML/CSS and JavaScript) <br/><b>param {Object}</b> widgets <br/><b>param {Object}</b> batchWidgets A list of all the widgets that need to load </p><br/><pre id="a15">var locateWidgets = function(containerId, showSettings, widgetData, context, callback) {</pre><p>Insert the widgets into the page <br/><b>param {String}</b> containerId The id of the container element <br/><b>param {Boolean}</b> showSettings Show the settings for the widget <br/><b>param {Object}</b> widgetData Widget data associated to the loaded widgets <br/><b>param {String}</b> context The context of the widget (e.g. siteid) </p><br/><pre id="a16">saveWidgetData : function(id, content, callback, removeTree) {</pre><p>Save the preference settings or data for a widget  <br/><b>param {String}</b> id The unique id of the widget <br/><b>param {Object}</b> content A JSON object that contains the data for the widget <br/><b>param {Function}</b> callback Callback function that gets executed after the save is complete <br/><b>param {Boolean}</b> removeTree If we should replace the entire tree of saved data or just update it <br/><b>return {Void}</b> </p><br/><pre id="a17">removeWidgetData : function(id, callback) {</pre><p>Remove the preference settings or data for a widget  <br/><b>param {String}</b> id The unique id of the widget <br/><b>param {Function}</b> callback Callback function that gets executed after the delete is complete <br/><b>return {Void}</b> </p><br/><pre id="a18">changeWidgetTitle : function(tuid, title) {</pre><p>Change the given widget's title  <br/><b>param {String}</b> tuid The tuid of the widget <br/><b>param {String}</b> title The title to change to </p><br/><pre id="a19">isOnDashboard : function(tuid) {</pre><p>Check if a widget is on a dashboard  <br/><b>param {String}</b> tuid The tuid of the widget <br/><b>return {Boolean}</b> true if on a dashboard, false if not (for example, on a page) </p><br/><pre id="a20">nofityWidgetShown : function(selector, showing) {</pre><p>Notify widgets when they have been shown or hidden, given a root element  <br/><b>param {String}</b> selector the root selector ('#theid') for the page which could house the widgets to nofity <br/><b>param {Boolean}</b> showing true if we are showing the widget, false if it is about to be hidden </p><br/><pre id="a21">bindToHash : function() {</pre><p>This binds to any links with a hash URL and handles the pushState for them </p><br/><pre id="a22">createHashURL : function(paramsObject, url) {</pre><p>This function is used for creating href's to link to a hash change <br/><b>param {Object}</b> paramsObject The object containing key value pairs to add to the URL <br/><b>param {String}</b> url          The url you want to add hash parameters to. If not provided, the system will use the current page URL. </p><br/><pre id="a23">handleHashChange : function(e) {</pre><p>Handle the hash change and dispatch the hashchange event to each widget that has the changed parameter <br/><b>param {Object}</b> e The hashchange event object </p><br/><pre id="a24">if (!$.isEmptyObject(sakai_widgets_config)) {</pre><p>construct the changedParams object which contains a map like this: widgetHashes = { 'widgetid' : { 'changed': {'property': 'value'}, 'deleted': {}}}; </p><br/><pre id="a25">getWidget: function(widgetid) {</pre><p>This function will return widget configuration for a specific widget <br/><b>param {Object}</b> widgetid     id of the widget as specified in the widget's config file </p><br/><pre id="a26">getWidgetTitle: function(widgetid) {</pre><p>This function will return the name of a widget in the current user's language <br/><b>param {Object}</b> widgetid  id of the widget as specified in the widget's config file </p><br/><pre id="a27">getWidgetDescription: function(widgetid) {</pre><p>This function will return the description of a widget in the current user's language <br/><b>param {Object}</b> widgetid  id of the widget as specified in the widget's config file </p><br/><pre id="a28">insertOnLoadWidgets: function() {</pre><p>Add the widgets that need to be present at all time on all pages </p><br/><pre id="a29">registerLazyLoading: function() {</pre><p>This function will register all widgets that require lazy loading </p><br/><pre id="a30">isRecursivelyEmbedded: function($rootel, poolID, ref) {</pre><p>Check to see if a widget is embeddded inside itself  <br/><b>param {jQuery}</b> $rootel The rootel of the widget <br/><b>param {String}</b> poolID The pool id of the widget <br/><b>param {String}</b> ref The _ref of the widget  <br/><b>return {Boolean}</b> if it is safe to embed the widget </p><br/></body></html>